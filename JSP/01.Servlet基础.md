# [JSP](./index.md) | 01 ServletåŸºç¡€

ğŸŒ¸Author [**Echo Pan**](https://github.com/echopan)

## æ¦‚å¿µ

Servletï¼ˆServer Appletï¼‰ï¼Œå…¨ç§°`Java Servlet`ã€‚  

Sevletæœ¬è´¨ä¸Šæ˜¯ä¸€æ®µ**Javaç¨‹åºæˆ–ä»£ç **ï¼Œå…¶è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œç”¨äºå“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚

Servletæ˜¯ç»§æ‰¿è‡ª`HttpServletç±»`çš„Javaç±»ï¼Œé€šå¸¸ç”±ä¸‰ä¸ªéƒ¨åˆ†æ„æˆï¼š  

- **å¯¼å…¥çš„åŒ…**  

  ```java
  import java.io.*;
  import javax.servlet.*;
  ...
  ```
  
- **å¤„ç†è¯·æ±‚çš„æ–¹æ³•**,åŒ…æ‹¬``doGet()``å’Œ``doPost()``æ–¹æ³•  

  ```java
  public void doGet(HttpServletRequest request,  
  HttpServletResponse response) throws 
  ServletException, IOException {
    //ä»£ç å—
    }
  ```

- **å‘å®¢æˆ·ç«¯å‘é€çš„æ•°æ®**
  
  ```java
  //ä¸Šé¢ä»£ç å—ä¸­çš„å†…å®¹
  response.setContext("text/html;charset=UTF-8");
  PrintWriter out=response.getWriter();
  out.println("<html><head>
  <title>MyJSP</title>
  </head>
    <body>
      Hello World!<br>
    </body>
  </html>");
  ```

## Servletå’ŒJSPçš„å…³ç³»

JSPç»è¿‡ç¼–è¯‘åç”Ÿæˆçš„å°±æ˜¯Servletæ–‡ä»¶ï¼ŒJSPæ˜¯Servletçš„ç®€åŒ–ï¼›  
JSPä¾§é‡è§†å›¾ï¼Œè€ŒServletä¸»è¦ç”¨äºé€»è¾‘æ§åˆ¶ã€‚

JSPæ˜¯Javaå’ŒHTMLç»„åˆçš„`.jsp`æ‰©å±•æ–‡ä»¶ï¼ŒSevletåˆ™æ˜¯çº¯Javaä»£ç ï¼›  
JSPä¸­æœ‰å†…ç½®å¯¹è±¡ï¼Œè€ŒSevletä¸­æ²¡æœ‰ã€‚

Servletèƒ½æ›´å¥½åœ°ç»„ç»‡ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œä½†æ˜¯HTMLä»£ç å¯è¯»æ€§å·®ã€ç»´æŠ¤å›°éš¾ï¼›  
JSPè™½ç„¶è§„é¿äº†ä¸Šè¿°åŠ£åŠ¿ï¼Œä½†æ˜¯ç”±äºåœ¨HTMLä¸­æ··å…¥å¤§é‡Javaä»£ç ï¼Œä¸€æ ·ä¸å¯å–ã€‚

æ³¨ï¼šåé¢å­¦çš„MVCè®¾è®¡æ¨¡å¼èƒ½å¤Ÿè§„é¿ä¸¤è€…çš„çŸ­æ¿ã€‚

## Servlet æ¥å£å’ŒAPI

Servlet APIæ‰€åœ¨åŒ…ï¼š

1. **javax.servletåŒ…**  
å¸¸ç”¨çš„åŒ…æ‹¬ **Servletã€ServletRequestã€ServletConfigã€ServletContextæ¥å£** ä»¥åŠ**æŠ½è±¡ç±»GenericServlet** ç­‰.
2. **javax.servlet.httpåŒ…**  
ç”¨äºæ”¯æŒHTTPçš„Servlet API.

å¤§æ¦‚è¿‡ç¨‹ï¼š  

&emsp;&emsp;å½“Webå®¹å™¨é¦–æ¬¡è½½å…¥ä¸€ä¸ªServletæ–‡ä»¶åï¼Œä¼šå»ºç«‹è¯¥æ–‡ä»¶çš„Servletæ¥å£å®ä¾‹ã€‚ç„¶åæ ¹æ®Servletæ¥å£è®¾å®šçš„åˆå§‹åŒ–é…ç½®å’Œå…¶ä»–ä¿¡æ¯ï¼ˆä¸€èˆ¬åœ¨web.xmlä¸­ï¼‰åˆ›å»ºä¸€ä¸ªServletConfigå®ä¾‹ã€‚é€šè¿‡Servletæ¥å£çš„init()æ–¹æ³•ä¼ å…¥è¯¥ServletConfigå®ä¾‹å®Œæˆå¯¹Servletå®ä¾‹çš„åˆå§‹åŒ–ã€‚  

&emsp;&emsp;Servletå®ä¾‹åˆå§‹åŒ–å®Œæˆåï¼Œå½“æ”¶åˆ°è¯·æ±‚æ—¶ï¼ŒWebå®¹å™¨ä¼šåˆ›å»ºHttpè¯·æ±‚å’Œå“åº”å¯¹è±¡ï¼Œå†é€šè¿‡urlPatternæ‰¾åˆ°å¯¹åº”çš„Servletå®ä¾‹ï¼Œè°ƒç”¨å…¶service()æ–¹æ³•ï¼Œä¼ å…¥ï¼ˆHttpï¼‰ServletRequestã€ï¼ˆHttpï¼‰ServletResponseå®ä¾‹ã€‚  

&emsp;&emsp;Webåº”ç”¨è¢«åœæ­¢æˆ–é‡æ–°å¯åŠ¨ä¹‹å‰ï¼ŒWebå®¹å™¨å°†è°ƒç”¨Servletå®ä¾‹çš„destroy()æ–¹æ³•é‡Šæ”¾èµ„æºå¹¶å¸è½½Servletã€‚

***
[*Servletè¿è¡Œè¿‡ç¨‹*](https://www.cnblogs.com/best/p/9295216.html#blogTitle1)

## Servlet æ¥å£

**æ‰€æœ‰çš„Servletç±»éƒ½å¿…é¡»å®ç°è¯¥æ¥å£ã€‚**  

Servlet æ¥å£å®šä¹‰äº†5ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­3ä¸ªç”±Servletå®¹å™¨è°ƒç”¨ï¼Œ2ä¸ªå¯ä»¥åœ¨JavaWebçš„ç¨‹åºä»£ç é‡Œè®¿é—®ã€‚  

1. **init(ServletConfig config)**  
è´Ÿè´£åˆå§‹åŒ–Servletå¯¹è±¡ï¼Œåœ¨Servletçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­åªè¢«è°ƒç”¨ä¸€æ¬¡  
2. **service(ServletRequest req, ServletResponse res)**  
è´Ÿè´£å“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå½“ç”¨æˆ·è¦æ±‚è®¿é—®ç‰¹å®šServletå¯¹è±¡æ—¶è°ƒç”¨  
3. **destroy()**  
è´Ÿè´£é‡Šæ”¾Servletå¯¹è±¡å ç”¨çš„èµ„æºï¼Œå½“Servletå¯¹è±¡ç»“æŸç”Ÿå‘½å‘¨æœŸæ—¶è°ƒç”¨

***

4. **getServletConfig()**  
è¿”å›ä¸€ä¸ªServletConfigå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«Servletçš„åˆå§‹åŒ–ä¿¡æ¯  
5. **getServletInfo()**  
è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶åŒ…å«äº†Servletåˆ›å»ºè€…ã€ç‰ˆæœ¬å’Œç‰ˆæƒç­‰ä¿¡æ¯

## GenericServlet æŠ½è±¡ç±»

ç”±äºServletæ¥å£ç¼–å†™çš„Servletç±»è¦å®ç°5ä¸ªæ–¹æ³•ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œäºæ˜¯æœ‰äº†GenericServletæŠ½è±¡ç±»ã€‚  

è¯¥ç±»å®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„ã€ä¸ä¾èµ–å…·ä½“åè®®çš„Servletï¼Œ**å®ç°äº†Servletæ¥å£å’ŒServletConfigæ¥å£**ã€‚è¯¥ç±»ç»™å‡ºäº†é™¤``service()``æ–¹æ³•ä»¥å¤–å…¶ä»–4ä¸ªæ–¹æ³•çš„ç®€å•å®ç°ã€‚é€šè¿‡GenericServletç¼–å†™Servletç±»åªéœ€å®ç°service()æ–¹æ³•å³å¯ã€‚

## HttpServlet æŠ½è±¡ç±»

ä¸€èˆ¬ï¼Œå®¢æˆ·ç«¯é€šè¿‡HTTPåè®®è®¿é—®æœåŠ¡å™¨èµ„æºã€‚Sunå…¬å¸æä¾›äº†æŠ½è±¡ç±»HttpServletï¼Œå®ƒ**ç»§æ‰¿è‡ªGenericServletç±»**ï¼Œç”¨æ¥åˆ›å»ºé€‚åˆWebç«™ç‚¹çš„HTTP Servletã€‚

é’ˆå¯¹HTTP1.1å®šä¹‰çš„7ç§è¯·æ±‚æ–¹æ³•ï¼ŒHttpServletæä¾›äº†7ä¸ªå¤„ç†æ–¹æ³•ï¼š

> doGet()ï¼ŒdoPost()ï¼ŒdoHead()ï¼ŒdoPut()ï¼ŒdoDelete()ï¼ŒdoTrace()ï¼ŒdoOptions()  

æ³¨ï¼šTRACEå’ŒOPTIONSåšäº†é€‚å½“å®ç°ï¼›  
&emsp;&emsp;å…¶ä»–5ä¸ªæ–¹æ³•åªæä¾›äº†è¿”å›HTTPé”™è¯¯çš„å®ç°ã€‚

æˆ‘ä»¬å¸¸ç”¨çš„ä¸€èˆ¬æ˜¯``doGet()``æ–¹æ³•å’Œ``doPost()``æ–¹æ³•ã€‚

å½“å®¹å™¨æ¥æ”¶åˆ°é’ˆå¯¹HttpServletå¯¹è±¡çš„è¯·æ±‚æ—¶ï¼Œè°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š  

1. è°ƒç”¨``Public service()``æ–¹æ³•  
2. åœ¨``Public service()``æ–¹æ³•ä¸­ï¼Œå°†å‚æ•°ç±»å‹è½¬æ¢ä¸º``HttpServletRequest``å’Œ``HttpServletResponse``ï¼Œç„¶åå°†è½¬æ¢åçš„è¿™ä¸¤ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™``Protected service()``æ–¹æ³•
3. åœ¨``Protected service()``æ–¹æ³•ä¸­ï¼Œé¦–å…ˆè°ƒç”¨``HttpServletRequest``å¯¹è±¡çš„``getMethod()``æ–¹æ³•ï¼Œè·å–HTTPè¯·æ±‚ç±»å‹ï¼Œè°ƒç”¨ç›¸åº”çš„``doXxx()``æ–¹æ³•

å› æ­¤ï¼Œåœ¨ç¼–å†™HttpServletçš„æ´¾ç”Ÿç±»æ—¶ï¼Œä¸€èˆ¬ä¸ç”¨è¦†å†™``service()``æ–¹æ³•ï¼Œè€Œåªéœ€è¦é‡å†™ç›¸åº”çš„``doXxx()``æ–¹æ³•å³å¯ã€‚

***
[*Servletæ¥å£å’Œç±»*](https://blog.csdn.net/qq_34594236/article/details/78345478)

## ä¸è¯·æ±‚å’Œå“åº”ç›¸å…³çš„æ¥å£

å½“å®¹å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ª``ServletRequest``å¯¹è±¡ï¼Œç”¨æ¥å°è£…è¯·æ±‚çš„æ•°æ®ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ª``ServletResponse``å¯¹è±¡ï¼Œç”¨æ¥å°è£…å“åº”çš„æ•°æ®ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥``service()``æ–¹æ³•ï¼ŒServletå†é€šè¿‡``service()``æ–¹æ³•è·å–è¯·æ±‚å’Œå‘é€å“åº”ã€‚  

``HttpServletRequest``æ¥å£å’Œ``HttpServletResponse``æ¥å£åˆ†åˆ«ç»§æ‰¿è‡ª``ServletRequest``æ¥å£å’Œ``ServletResponse``æ¥å£ï¼Œå¹¶åœ¨åŸæœ‰åŸºç¡€ä¸Šæ–°å¢äº†ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚è¯·æ±‚å¸¸ç”¨çš„``getSession()``æ–¹æ³•ï¼Œå“åº”å¸¸ç”¨çš„``sendRedirect()``æ–¹æ³•ã€‚

## ServletConfig æ¥å£ - Servleté…ç½®ä¿¡æ¯

åˆå§‹åŒ–Servletå¯¹è±¡æ—¶ï¼Œä½¿ç”¨``ServletConfig``å¯¹è±¡è·å–åˆå§‹åŒ–å‚æ•°ï¼ˆä»web.xmlä¸­è·å–ï¼‰ã€‚ä¸€ä¸ªServletåªæœ‰ä¸€ä¸ªServletConfigå¯¹è±¡ã€‚

åœ¨ServletConfigæ¥å£ä¸­ï¼Œå®šä¹‰äº†4ä¸ªæ–¹æ³•ï¼š

1. **getInitParameter()**
é€šè¿‡ä¼ å…¥çš„å‚æ•°åè·å–å¯¹åº”åˆå§‹å‚æ•°å€¼ï¼Œå³``web.xml``é…ç½®ä¸­çš„``<init-param>``å‚æ•°æˆ–è€…``@WebServlet``æ³¨è§£ä¸­çš„``initParams``å±æ€§å…ƒç´ ï¼›  
2. **getInitParameterNames()**
è¿”å›ä¸€ä¸ª``Enumeration<String>``å¯¹è±¡ï¼Œæ²¡æœ‰å‚æ•°æ—¶è¿”å›ç©ºå€¼ï¼›
3. **getServletContext()**
è¿”å›å½“å‰æ­£åœ¨è¿è¡Œçš„webåº”ç”¨çš„ServletContextå¯¹è±¡ï¼›
4. **getServletName()**
è¿”å›Servletå®ä¾‹çš„åç§°ï¼Œå³``web.xml``é…ç½®ä¸­çš„``<servlet-name>``æˆ–``@WebServlet``ä¸­çš„nameå±æ€§ï¼Œæœªé…ç½®æ—¶è¿”å›è¯¥å®ä¾‹çš„ç±»åï¼ˆå¯é€šè¿‡xxx.class.getName()è·å–ï¼‰ã€‚

**æ³¨* ä¸Šé¢æåˆ°çš„é…ç½®æ–‡ä»¶å’Œæ³¨è§£ç›¸å…³çš„çŸ¥è¯†ä¼šåœ¨åé¢è¯´

***
[*ServletConfigè¯¦è§£*](https://blog.csdn.net/qq_34666857/article/details/104517970)

## ServletContext æ¥å£ - Servletä¸Šä¸‹æ–‡

Webå®¹å™¨ä¼šä¸ºæ¯ä¸ªWebåº”ç”¨åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œåº”ç”¨ä¸­çš„æ‰€æœ‰Servletå…±äº«è¯¥å¯¹è±¡ï¼Œä¸åŒServletä¹‹é—´å¯ä»¥é€šè¿‡è¯¥å¯¹è±¡å®ç°èµ„æºä¼ é€’å’Œå…±äº«ï¼Œå› æ­¤``ServletContext``å¯¹è±¡ä¹Ÿè¢«ç§°ä¸º``Context``åŸŸå¯¹è±¡ã€‚  

æˆ‘ä»¬å¯ä»¥é€šè¿‡4ç§æ–¹å¼è·å–``ServletContext``å¯¹è±¡ï¼š

```java
//1.GenericServlet çš„ getServletContext æ–¹æ³•
ServletContext servletContext = this.getServletContext();
//2.ServletConfig çš„ getServletContext æ–¹æ³•
ServletContext servletContext = this.getServletConfig().getServletContext();

//ä¸‹é¢çš„æ–¹æ³•æš‚ä½œäº†è§£å³å¯
//3.HttpSession çš„ getServletContext æ–¹æ³•
ServletContext servletContext = request.getSession().getServletContext();
//4.HttpServletRequest çš„ getServletContext æ–¹æ³•
ServletContext servletContext = request.getServletContext();
```

é€šè¿‡``ServletContext``å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆå§‹åŒ–å‚æ•°ã€Webåº”ç”¨ä¸­çš„æ–‡ä»¶ä»¥åŠå®ç°Servletä¹‹é—´çš„æ•°æ®ä¼ é€’ã€‚

***
[*ServletContextæ¥å£è¯¦è§£*](http://c.biancheng.net/servlet2/servletcontext.html)

## RequestDispatcher æ¥å£ - è¯·æ±‚è½¬å‘

é€šè¿‡``RequestDispatcher``å¯¹è±¡å®ç°è¯·æ±‚è½¬å‘ã€‚

### è·å–è½¬å‘å¯¹è±¡çš„æ–¹æ³•

1. ``ServletRequest``æ¥å£çš„``RequestDispatcher()`` æ–¹æ³•  
2. ``ServletContext``æ¥å£çš„``getNamedDispatcher()`` æ–¹æ³•  
3. ``ServletContext``æ¥å£çš„``getRequestDispatcher()`` æ–¹æ³•  

### è½¬å‘è¯·æ±‚çš„æ–¹æ³•

1. ``forward()`` æ–¹æ³•  
å°†å®¢æˆ·ç«¯è¯·æ±‚è½¬å‘ç»™å…¶ä»–serverèµ„æºï¼ˆservletã€jspã€htmlï¼‰å¤„ç†å¹¶è¿”å›å“åº”ï¼ŒåŸç½‘é¡µåœæ­¢æ‰§è¡Œï¼Œæµè§ˆå™¨åœ°å€ä¸å˜
2. ``include()`` æ–¹æ³•  
åœ¨å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼ŒåŒæ—¶æ·»åŠ å…¶ä»–serverèµ„æºå¹¶è¿”å›å“åº”ï¼ŒåŸç½‘é¡µå¯ä»¥ç»§ç»­è¾“å‡ºå“åº”ä¿¡æ¯ï¼Œæµè§ˆå™¨åœ°å€ä¸å˜

```java
//forward() æ–¹æ³•
public void forward(ServletRequest request, ServletResponse response)
   throws ServletException, IOException;

//include() æ–¹æ³•
public void include(ServletRequest request, ServletResponse response)
   throws ServletException, IOException;
```

***
[*RequestDispatcheræºç è§£æ*](https://blog.csdn.net/chinabestchina/article/details/104216078)

***

[ä¸Šä¸€ç« ï¼š00.å¼€å§‹ä¹‹å‰](./00.å¼€å§‹ä¹‹å‰.md)  

[ä¸‹ä¸€ç« ï¼š00.ServletåŸºç¡€](./01.ServletåŸºç¡€.md)  

[è¿”å›ç›®å½•](./index.md)