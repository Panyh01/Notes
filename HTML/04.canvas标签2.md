# [HTML](./index.md) | 04 canvasæ ‡ç­¾2<!-- omit in toc -->

ğŸŒ¸Author [**Echo Pan**](https://github.com/echopan)

- [è·¯å¾„å­˜å‚¨ Path2D](#è·¯å¾„å­˜å‚¨-path2d)
- [é«˜æ¸…ç»˜å›¾](#é«˜æ¸…ç»˜å›¾)
  - [ç‰©ç†åƒç´  Physical Pixel](#ç‰©ç†åƒç´ -physical-pixel)
  - [è®¾å¤‡ç‹¬ç«‹åƒç´  DIP](#è®¾å¤‡ç‹¬ç«‹åƒç´ -dip)
  - [ç‰©ç†åƒç´ å’Œ DIP çš„å…³è”](#ç‰©ç†åƒç´ å’Œ-dip-çš„å…³è”)
  - [è®¾å¤‡åƒç´ æ¯”](#è®¾å¤‡åƒç´ æ¯”)
  - [å…·ä½“å®ç°](#å…·ä½“å®ç°)
- [ä¸‰è§’å‡½æ•°](#ä¸‰è§’å‡½æ•°)
  - [é¥¼å›¾å’Œå¼•å¯¼çº¿](#é¥¼å›¾å’Œå¼•å¯¼çº¿)
  - [ç®€å•ä¸‰è§’å‡½æ•°](#ç®€å•ä¸‰è§’å‡½æ•°)

***

## âœ¨Echoæœ‰è¯è¯´<!-- omit in toc -->

å‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†åˆ©ç”¨`canvas`ç”»å¸ƒæ¥ç»˜åˆ¶çŸ©å½¢ã€è™šå®çº¿ã€åœ†å¼§ã€å›¾åƒã€æ–‡å­—ç­‰ï¼Œè¿˜åŒ…æ‹¬é¢œè‰²ã€å¤§å°ç­‰å˜åŒ–ã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥å­¦ä¹ æ›´å¤šå…³äº`canvas`æ ‡ç­¾çš„å†…å®¹ã€‚

[_Canvasæ•™ç¨‹_](https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial)

## è·¯å¾„å­˜å‚¨ Path2D

è¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§åŠŸèƒ½ï¼Œå°†ç»˜åˆ¶çš„è·¯å¾„å­˜å‚¨åˆ°`path2D`å¯¹è±¡ä¸­ã€‚å†é€šè¿‡`stroke()`æˆ–`fill()`ç»˜åˆ¶å‡ºæ¥ã€‚

è¯¥å‡½æ•°æ”¯æŒ`canvas`æˆ–`svg`è·¯å¾„ã€‚

```js
//æ–°å»ºè·¯å¾„å­˜å‚¨
var route1=new Path2D();
route1.rect(10,10,50,50);
//æ‹·è´è·¯å¾„å­˜å‚¨
var route2=new Path2D(route1);
route2.moveTo(125,35);
route2.arc(100,35,25,0,Math.PI*2);
//ä½¿ç”¨Path2Då¯¹è±¡ä½œä¸ºç»˜åˆ¶å‚æ•°
ctx.stroke(route2);
//ä½¿ç”¨svgè·¯å¾„
var route3=new Path2D('M10 80 h 50 v 50 h -50 Z');
ctx.fill(route3);
/*
M:moveTo
h:æ°´å¹³ä½ç§»ï¼Œhorizontal
v:å‚ç›´ä½ç§»ï¼Œvertical
Z:closePath
å¤§å†™è¡¨ç¤ºç»å¯¹å®šä½ï¼Œå°å†™è¡¨ç¤ºç›¸å¯¹å®šä½
*/
```

[_SVGè·¯å¾„_](https://www.w3school.com.cn/svg/svg_path.asp)&emsp;[_Path2D_](https://developer.mozilla.org/zh-CN/docs/Web/API/Path2D/Path2D)

## é«˜æ¸…ç»˜å›¾

### ç‰©ç†åƒç´  Physical Pixel

ç‰©ç†åƒç´ ï¼Œä¹Ÿå«è®¾å¤‡åƒç´ ï¼Œæ˜¯æŒ‡è®¾å¤‡èƒ½æ§åˆ¶æ˜¾ç¤ºçš„æœ€å°å•ä½,å³å±å¹•åˆ†è¾¨ç‡ã€‚

### è®¾å¤‡ç‹¬ç«‹åƒç´  DIP

Device Independent Pixelsï¼Œé€»è¾‘ä¸Šè¡¡é‡åƒç´ çš„å•ä½ã€‚

### ç‰©ç†åƒç´ å’Œ DIP çš„å…³è”

å±å¹•åˆ†è¾¨ç‡éšæ˜¾ç¤ºå™¨åˆ¶é€ æŠ€æœ¯çš„è¿›æ­¥è€Œæé«˜ï¼Œå¦‚æœåœ¨ä¸åŒåˆ†è¾¨ç‡çš„è®¾å¤‡ä¸Šéƒ½ç”¨12ä¸ªç‰©ç†åƒç´ è¡¨ç¤ºå­—ä½“ï¼Œé‚£ä¹ˆå­—ä½“å¯èƒ½ä¼šå‡ºç°æ‰­æ›²å˜å½¢ï¼Œä¸ºäº†è®©å­—ä½“èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œå°±è¦ç”¨é€»è¾‘åƒç´ æ¥è¡¨ç¤ºå­—ä½“çš„å¤§å°ã€‚1é€»è¾‘åƒç´ çš„å•ä½å¤§å°å¯ä»¥æ ¹æ®ä¸åŒçš„ç‰©ç†åƒç´ è¿›è¡Œè°ƒæ•´ï¼Œä»è€Œä½¿å†…å®¹åœ¨ä¸åŒè®¾å¤‡ä¸Šéƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚

### è®¾å¤‡åƒç´ æ¯”

`window.devicePixelRatio`æ˜¯ç‰©ç†åƒç´ å’Œè®¾å¤‡ç‹¬ç«‹åƒç´ çš„æ¯”å€¼ï¼Œå…¬å¼ä¸º`window.devicePixelRatio = ç‰©ç†åƒç´  / dips`ã€‚

### å…·ä½“å®ç°

ç½‘ä¸Šåƒç¯‡ä¸€å¾‹çš„è€åŠæ³•é‡Œæ¶‰åŠåˆ°äº†`canvas`ç”»å¸ƒçš„`BackingStorePixelRatio`å±æ€§ï¼Œè¯´æ˜¯`canvas`ç¼“å­˜é‡Œçš„åƒç´ å¤§å°ï¼Œä¸è¿‡è¯¥å±æ€§å·²ç»è¢«åºŸå¼ƒäº†ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆä¸åšæ¢ç©¶ã€‚

é¦–å…ˆæˆ‘ä»¬è·å–`window.devicePixelRatio`å‚æ•°

ç„¶åå°†`canvas.width`å’Œ`canvas.height`å…ˆèµ‹å€¼ç»™`CSS`å®½é«˜ï¼Œå†å°†å®ƒä¿©æ”¾å¤§`window.devicePixelRatio`å€ï¼Œç›¸å½“äºè¿˜åŸæˆåœ¨ç‰©ç†åƒç´ ä¸­çš„çœŸå®è¡¨ç°ã€‚

æœ€åæ˜¾ç¤ºçš„æ•ˆæœæ˜¯ï¼Œåœ¨æ›´å¤§åˆ†è¾¨ç‡ä¸­ç»˜åˆ¶çš„å›¾å½¢ç¼©å°åˆ°åŸå§‹å¤§å°çš„æ¡†æ¶ä¸­æ—¶ï¼Œä¼šæ¯”æœ¬æ¥æ›´æ¸…æ™°ã€‚

ä»£ç ï¼š

```js
    var canvas=document.getElementsByTagName("canvas")[0];
    ratio=window.devicePixelRatio||1;
    canvas.style.width=canvas.Width+'px';
    canvas.style.height=canvas.height+'px';
    canvas.width=ratio*canvas.width;
    canvas.height=ratio*canvas.height;
    var ctx=canvas.getContext("2d");
    ctx.arc(canvas.width/2,canvas.height/2,120*ratio,0,Math.PI*2);
    ctx.stroke();
```

å“ˆå“ˆå“ˆï¼ŒèµåŒï¼š

[BTW, even though I can empirically confirm that the accepted answer below is correct, I find it fairly amusing that it involves zero explanation of the difference between `backingStorePixelRatio` and `devicePixelRatio`. Worse, nobody on the internet seems to have any idea why `backingStorePixelRatio` ever needed to exist in addition to `devicePixelRatio`, when that changed, or why that changed. Every seems to be like "Oh, hey, just write these 2 lines of code and you're good! Bye!"](https://stackoverflow.com/questions/24332639/why-context2d-backingstorepixelratio-deprecated)

[_é«˜åˆ†è¾¨ç‡Canvas_](https://www.jianshu.com/p/2cd5143cf9aa)&emsp;[_ç‰©ç†/é€»è¾‘åƒç´ _](https://www.jianshu.com/p/6b1f94bfa263)&emsp;[_è§£å†³canvasç»˜åˆ¶æ¨¡ç³Šé—®é¢˜_](https://blog.csdn.net/suwu150/article/details/97759162)

## ä¸‰è§’å‡½æ•°

### é¥¼å›¾å’Œå¼•å¯¼çº¿

ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šäº†è§£è¿™ä¸ªï¼Œè¿˜å¾—ä»åšé¥¼å›¾è¯´èµ·...

åšé¥¼å›¾è¦åŠ ä¸ªå¼•å¯¼çº¿ï¼Œå¼•å¯¼çº¿çš„èµ·å§‹ä½ç½®è·å–æ€è·¯æ˜¯ï¼Œæˆ‘ä»¬è¦æŠŠå¼•å¯¼çº¿ç”»åœ¨æ‰‡å½¢çš„ä¸­çº¿ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ‰‡å½¢åœ†è§’/2çš„åº¦æ•°ï¼›

å†åŠ ä¸Š0è¾¹åˆ°æ‰‡å½¢èµ·å§‹è¾¹çš„å¼§åº¦ï¼Œå¯ä»¥å¾—åˆ°ä»¥0è¾¹ã€ä¸­çº¿å’Œç¬¬ä¸‰è¾¹ä¸ºè¾¹çš„ç›´è§’ä¸‰è§’å½¢ï¼›

å†é€šè¿‡ä¸‰è§’å‡½æ•°è®¡ç®—å¾—åˆ°ç¬¬ä¸‰è¾¹å’Œ0è¾¹çš„é•¿åº¦ï¼›

ç”±äºåœ†å¿ƒä½ç½®å·²çŸ¥ï¼Œæ‰€ä»¥é€šè¿‡ä¸¤è¾¹é•¿åº¦å¯ä»¥å¾—å‡ºç»ˆç‚¹çš„ä½ç½®ï¼Œå†ä»åœ†å¿ƒåˆ°ç»ˆç‚¹ä½ç½®ç”»çº¿å°±å¯ä»¥ç”»å‡ºå¼•å¯¼çº¿äº†ã€‚

[_canvasé¥¼å›¾ç»˜åˆ¶_](https://blog.csdn.net/qq_38944959/article/details/88321304)&emsp;[_canvasè·å–arcåæ ‡_](https://www.5axxw.com/questions/content/2a7jb6)

### ç®€å•ä¸‰è§’å‡½æ•°

```js
Math.sin(å¼§åº¦)
Math.cos(å¼§åº¦)
Math.tan(å¼§åº¦)
```

[_ï¼ˆåï¼‰ä¸‰è§’å‡½æ•°_](https://zhuanlan.zhihu.com/p/103033370)

***
[ä¸Šä¸€ç« ï¼š03.canvasæ ‡ç­¾](./03.canvasæ ‡ç­¾.md)  

[ä¸‹ä¸€ç« ï¼š00.å¼€å§‹ä¹‹å‰](./00.å¼€å§‹ä¹‹å‰.md)  

[è¿”å›ç›®å½•](./index.md)